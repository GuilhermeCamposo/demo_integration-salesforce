= Salesforce Webhook Ingestor


== How to build with OpenShift
----
oc new-build java:openjdk-11-el7~https://gitlab.com/rhi-demo/salesforce-webhook-ingestor.git
oc patch bc/salesforce-webhook-ingestor -p '{"spec":{ "strategy":{ "sourceStrategy":{ "incremental": true } } }}'
----

== Required environment variables

[options="header"]
|=======================
| Variable | Example Value                                      | Definition
| SF_CLIENT_ID | |
| SF_CLIENT_SECRET | |
| SF_USERNAME | |
| SF_PASSWORD | |
| SF_INSTANCE | |
| AB_JOLOKIA_OFF | true | Jolokia doesn't work with Quarkus
|=======================

== Create a secret for Salesforce credentials

----
oc create secret generic salesforce-secret --from-literal=SF_CLIENT_ID= --from-literal=SF_CLIENT_SECRET= --from-literal=SF_USERNAME= --from-literal=SF_PASSWORD= --from-literal=SF_INSTANCE=
----

== Salesforce Configuration

=== Create an Apex Trigger

----
Trigger rhi_demo_opportunity on Opportunity (after insert,after update,after delete,after undelete) {

    String url = '3scale Product url + user_key';

    String content = Webhook.jsonContent(Trigger.new, Trigger.old);

    Webhook.callout(url, content);

}
----